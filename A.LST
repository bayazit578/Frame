Turbo Assembler	 Version 4.1	    02/12/26 17:11:58	    Page 1
a.asm



      1	0000			     .model tiny
      2	0000			     .code
      3				     org 100h
      4
      5	      =0019		     COLUMN	 equ 19h
      6	      =0050		     STRING	 equ 50h
      7	      =B800		     VRAMSEG	 equ 0b800h
      8	      =0004		     TXT_COL	 equ 00000100b
      9	      =0004		     FRAME_COL1	 equ 00000100b
     10	      =0004		     FRAME_COL2	 equ 00000100b
     11	      =0004		     FRAME_COL3	 equ 00000100b
     12
     13	0100			     start:
     14	0100  B8 B800				 mov   ax, VRAMSEG			     ;video segment
     15	0103  8E C0				 mov   es, ax
     16
     17	0105  E8 0021				 call  half_column			     ;half column -> bx
     18
     19	0108  E8 0024				 call  half_string			     ;half str -> dx
     20	010B  E8 0027				 call  half_cmd_string			     ;half cmd str -> cx
     21	010E  2B D1				 sub   dx, cx
     22
     23	0110  E8 0034				 call  calc_txt_address			     ;address arithmetics -> di
     24
     25	0113  E8 0025				 call  get_cmd_length			     ;length ->	cx
     26
     27	0116  BE 0082				 mov   si, 82h
     28	0119  B4 04				 mov   ah, TXT_COL
     29
     30	011B  57				 push  di
     31
     32	011C				     text_loop:
     33	011C  AC				 lodsb
     34	011D  AB				 stosw
     35	011E  E2 FC				 loop  text_loop
     36
     37	0120  5F				 pop   di
     38
     39	0121  E8 002F				 call  draw_frame_1
     40
     41	0124				     end_loop:						     ;if cx == 0
     42	0124  B8 4C00				 mov   ax, 4c00h
     43	0127  CD 21				 int   21h
     44
     45	0129			     half_column:
     46	0129  BB 0019				 mov   bx, COLUMN
     47	012C  D1 EB				 shr   bx, 1
     48	012E  C3				 ret
     49
     50	012F			     half_string:
     51	012F  BA 0050				 mov   dx, STRING
     52	0132  D1 EA				 shr   dx, 1
     53	0134  C3				 ret
     54
     55	0135			     half_cmd_string:
     56	0135  E8 0003				 call  get_cmd_length
     57	0138  D1 E9				 shr   cx, 1
Turbo Assembler	 Version 4.1	    02/12/26 17:11:58	    Page 2
a.asm



     58	013A  C3				 ret
     59
     60	013B			     get_cmd_length:
     61	013B  BE 0080				 mov   si, 80h
     62	013E  8A 0C				 mov   cl, byte	ptr ds:[si]
     63	0140  E3 E2				 jcxz  end_loop
     64	0142  FE C9				 dec   cl
     65	0144  32 ED				 xor   ch, ch
     66	0146  C3				 ret
     67
     68	0147			     calc_txt_address :
     69	0147  B8 0050				 mov   ax, STRING
     70	014A  F6 E3				 mul   bl
     71	014C  03 C2				 add   ax, dx
     72	014E  D1 E0				 shl   ax, 1
     73	0150  8B F8				 mov   di, ax
     74	0152  C3				 ret
     75
     76	0153			     draw_frame_1:
     77	0153  BB 0052				 mov   bx, (STRING + 2)
     78	0156  D1 E3				 shl   bx, 1
     79	0158  2B FB				 sub   di, bx
     80
     81	015A  B4 04				 mov   ah, FRAME_COL1
     82
     83	015C  B0 C9				 mov   al, 0c9h
     84	015E  AB				 stosw
     85
     86	015F  E8 FFD9				 call  get_cmd_length
     87	0162  83 C1 02				 add   cx, 02h
     88
     89	0165  B0 CD				 mov   al, 0cdh
     90	0167				     top_frame_loop:
     91	0167  AB				 stosw
     92	0168  E2 FD				 loop  top_frame_loop
     93
     94	016A  B0 BB				 mov   al, 0bbh
     95	016C  AB				 stosw
     96
     97	016D  BB 004F				 mov   bx, (STRING - 1)
     98	0170  D1 E3				 shl   bx, 1
     99	0172  03 FB				 add   di, bx
    100
    101	0174  B0 BA				 mov   al, 0bah
    102	0176  AB				 stosw
    103
    104	0177  03 FB				 add   di, bx
    105
    106	0179  FD				 std					     ;df = 1 ->	-= 2
    107
    108	017A  B0 BC				 mov   al, 0bch
    109	017C  AB				 stosw
    110
    111	017D  E8 FFBB				 call  get_cmd_length
    112	0180  83 C1 02				 add   cx, 02h
    113
    114	0183  B0 CD				 mov   al, 0cdh
Turbo Assembler	 Version 4.1	    02/12/26 17:11:58	    Page 3
a.asm



    115	0185				     bottom_frame_loop:
    116	0185  AB				 stosw
    117	0186  E2 FD				 loop  bottom_frame_loop
    118
    119	0188  B0 C8				 mov   al, 0c8h
    120	018A  AB				 stosw
    121
    122	018B  BB 004F				 mov   bx, (STRING - 1)
    123	018E  D1 E3				 shl   bx, 1
    124	0190  2B FB				 sub   di, bx
    125
    126	0192  B0 BA				 mov   al, 0bah
    127	0194  AB				 stosw
    128
    129	0195  C3				 ret
    130
    131				     end start
Turbo Assembler	 Version 4.1	    02/12/26 17:11:58	    Page 4
Symbol Table




Symbol Name			  Type	 Value

??DATE				  Text	 "02/12/26"
??FILENAME			  Text	 "a	  "
??TIME				  Text	 "17:11:58"
??VERSION			  Number 040A
@32BIT				  Text	 0
@CODE				  Text	 DGROUP
@CODESIZE			  Text	 0
@CPU				  Text	 0101H
@CURSEG				  Text	 _TEXT
@DATA				  Text	 DGROUP
@DATASIZE			  Text	 0
@FILENAME			  Text	 A
@INTERFACE			  Text	 000H
@MODEL				  Text	 1
@STACK				  Text	 DGROUP
@WORDSIZE			  Text	 2
BOTTOM_FRAME_LOOP		  Near	 DGROUP:0185
CALC_TXT_ADDRESS		  Near	 DGROUP:0147
COLUMN				  Number 0019
DRAW_FRAME_1			  Near	 DGROUP:0153
END_LOOP			  Near	 DGROUP:0124
FRAME_COL1			  Number 0004
FRAME_COL2			  Number 0004
FRAME_COL3			  Number 0004
GET_CMD_LENGTH			  Near	 DGROUP:013B
HALF_CMD_STRING			  Near	 DGROUP:0135
HALF_COLUMN			  Near	 DGROUP:0129
HALF_STRING			  Near	 DGROUP:012F
START				  Near	 DGROUP:0100
STRING				  Number 0050
TEXT_LOOP			  Near	 DGROUP:011C
TOP_FRAME_LOOP			  Near	 DGROUP:0167
TXT_COL				  Number 0004
VRAMSEG				  Number B800

Groups & Segments		  Bit Size Align  Combine Class

DGROUP				  Group
  _DATA				  16  0000 Word	  Public  DATA
  _TEXT				  16  0196 Word	  Public  CODE
